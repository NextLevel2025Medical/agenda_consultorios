{% extends "base.html" %}
{% block content %}
<div class="grid grid-cols-1 xl:grid-cols-[minmax(0,1fr)_340px] gap-6">
  <div class="xl:col-span-2 rounded-2xl bg-white/5 border border-white/10 p-6">
    <div class="flex flex-col md:flex-row md:items-end gap-4 justify-between">
      <div>
        <div class="text-sm text-slate-400">Modo Secretaria/Admin</div>
        <div class="text-lg font-semibold">Reservas</div>
      </div>

      <div class="flex items-center gap-3">
        <label class="text-sm text-slate-300">Data</label>
        <input
          class="rounded-xl bg-slate-900/60 border border-white/10 px-4 py-2 outline-none focus:border-white/30"
          type="date"
          name="date"
          value="{{ selected_date }}"
          hx-get="/admin/availability"
          hx-target="#availability"
          hx-trigger="change, load"
          hx-include="[name='date']"
        />
      </div>
    </div>

    <div id="availability" class="mt-6">  {% include "partials/availability.html" %}</div>
  </div>

  <div class="rounded-2xl bg-white/5 border border-white/10 p-6">
    <div class="text-sm text-slate-400">Fila</div>
    <div class="text-lg font-semibold">Solicitações Pendentes</div>

    <div class="mt-4 space-y-3">
      {% for r in pending_requests %}
        <div class="rounded-xl bg-white/5 border border-white/10 p-4">
          <div class="text-sm text-slate-300">
            <b>{{ r.doctor_name }}</b> · {{ r.room_name }}
          </div>
          <div class="text-sm text-slate-400 mt-1">
            {{ r.date_str }} · {{ r.time_str }}
          </div>

          <div class="mt-3 flex gap-2">
            <form method="post" action="/admin/requests/{{ r.id }}/approve">
              <button class="rounded-xl bg-emerald-500/90 px-3 py-2 text-sm font-medium text-slate-950 hover:bg-emerald-500 transition">
                Aprovar
              </button>
            </form>
            <form method="post" action="/admin/requests/{{ r.id }}/deny">
              <button class="rounded-xl bg-white/10 px-3 py-2 text-sm hover:bg-white/15 transition">
                Recusar
              </button>
            </form>
          </div>
        </div>
      {% else %}
        <div class="rounded-xl bg-white/5 border border-white/10 p-4 text-sm text-slate-400">
          Nenhuma solicitação pendente.
        </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
